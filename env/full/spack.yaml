spack:
  specs:
  - matrix:
    # Install all ska-sdp-spack packages that currently build successfully
    - [
        aoflagger, dal2, ducc, everybeam, idg, pmt, py-ducc, rum,
        casacore@3.6.1,
        dp3, dysco@1.2, 
        # py-casacore@3.6.1,
        wsclean@3.4,
        ska-sdp-exec-iotest@latest+mkl
    ]
    # GCC 11.4.0 is available natively on Ubuntu 22.04
    - ['%gcc@11.4.0']
    # We target the x86_64_v3 platform (i.e. AVX2 support including FMA, but not AVX512)
    - [platform=linux os=ubuntu22.04 target=x86_64_v3]
  # We do not need a view, should use either "spack load" or module files
  view: false
  # For the moment we unify - likely will need to fall back to when_possible later
  concretizer:
    unify: when_possible
  # Use ska_sdp_spack package repository
  repos:
  - ../..
  # Generate TCL module files
  modules:
    default:
      enable: [tcl]
  # Use official Spack build cache. In the future we will likely want to replace this
  # by the SKA CAR in some fashion
  mirrors:
    v0.23.0: https://binaries.spack.io/v0.23.0
